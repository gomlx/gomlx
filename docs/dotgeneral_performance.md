# DotGeneral Performance

This document is generated by running the `TestDotGeneral_PerformanceTable` test. 
To run it, from the root of the repository, run (for the simplego backend):

```bash
GOMLX_BACKEND=go go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

## Results

### Backend: `go` / CPU AMD 9950X3D / 2026-01-07

```bash
GOMLX_BACKEND=go go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `NoBatch-Tiny` | {128, 4} | {4, 1} | Float32 | 1 | 3.09µs | 1,024 | 0.3 |
| `NoBatch-Tiny` | {128, 4} | {4, 1} | Float64 | 1 | 3.10µs | 1,024 | 0.3 |
| `NoBatch-Tiny` | {128, 4} | {4, 1} | BFloat16 | 1 | 3.29µs | 1,024 | 0.3 |
| `NoBatch-Tiny` | {128, 4} | {4, 1} | Float16 | 1 | 4.48µs | 1,024 | 0.2 |
| `NoBatch-Tiny-Norm` | {128, 4} | {1, 4} | Float32 | 1 | 3.50µs | 1,024 | 0.3 |
| `NoBatch-Tiny-Norm` | {128, 4} | {1, 4} | Float64 | 1 | 3.48µs | 1,024 | 0.3 |
| `NoBatch-Tiny-Norm` | {128, 4} | {1, 4} | BFloat16 | 1 | 3.86µs | 1,024 | 0.3 |
| `NoBatch-Tiny-Norm` | {128, 4} | {1, 4} | Float16 | 1 | 5.29µs | 1,024 | 0.2 |
| `NoBatch-Small` | {16, 128} | {128, 32} | Float32 | 1 | 25.52µs | 131,072 | 5.1 |
| `NoBatch-Small` | {16, 128} | {128, 32} | Float64 | 1 | 25.61µs | 131,072 | 5.1 |
| `NoBatch-Small` | {16, 128} | {128, 32} | BFloat16 | 1 | 42.63µs | 131,072 | 3.1 |
| `NoBatch-Small` | {16, 128} | {128, 32} | Float16 | 1 | 139.44µs | 131,072 | 0.9 |
| `NoBatch-Medium` | {128, 128} | {128, 256} | Float32 | 1 | 276.47µs | 8,388,608 | 30.3 |
| `NoBatch-Medium` | {128, 128} | {128, 256} | Float64 | 1 | 289.78µs | 8,388,608 | 28.9 |
| `NoBatch-Medium` | {128, 128} | {128, 256} | BFloat16 | 1 | 645.61µs | 8,388,608 | 13.0 |
| `NoBatch-Medium` | {128, 128} | {128, 256} | Float16 | 1 | 1.58ms | 8,388,608 | 5.3 |
| `NoBatch-Large` | {1536, 1920} | {1920, 1024} | Float32 | 1 | 48.13ms | 6,039,797,760 | 125.5 |
| `NoBatch-Large` | {1536, 1920} | {1920, 1024} | Float64 | 1 | 49.11ms | 6,039,797,760 | 123.0 |
| `NoBatch-Large` | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 121.25ms | 6,039,797,760 | 49.8 |
| `NoBatch-Large` | {1536, 1920} | {1920, 1024} | Float16 | 1 | 383.13ms | 6,039,797,760 | 15.8 |
| `R-Unbalanced-Cross` | {128} | {128, 256} | Float32 | 1 | 23.25µs | 65,536 | 2.8 |
| `R-Unbalanced-Cross` | {128} | {128, 256} | Float64 | 1 | 28.52µs | 65,536 | 2.3 |
| `R-Unbalanced-Cross` | {128} | {128, 256} | BFloat16 | 1 | 25.77µs | 65,536 | 2.5 |
| `R-Unbalanced-Cross` | {128} | {128, 256} | Float16 | 1 | 71.62µs | 65,536 | 0.9 |
| `L-Unbalanced-Cross` | {4096, 32} | {32, 16} | Float32 | 1 | 332.89µs | 4,194,304 | 12.6 |
| `L-Unbalanced-Cross` | {4096, 32} | {32, 16} | Float64 | 1 | 348.84µs | 4,194,304 | 12.0 |
| `L-Unbalanced-Cross` | {4096, 32} | {32, 16} | BFloat16 | 1 | 591.43µs | 4,194,304 | 7.1 |
| `L-Unbalanced-Cross` | {4096, 32} | {32, 16} | Float16 | 1 | 1.18ms | 4,194,304 | 3.6 |
| `LargeBatch-Tiny` | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 128.02µs | 1,048,576 | 8.2 |
| `LargeBatch-Tiny` | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 130.07µs | 1,048,576 | 8.1 |
| `LargeBatch-Tiny` | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 198.38µs | 1,048,576 | 5.3 |
| `LargeBatch-Tiny` | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 392.79µs | 1,048,576 | 2.7 |
| `LargeBatch-Small` | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 511.94µs | 2,097,152 | 4.1 |
| `LargeBatch-Small` | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 499.13µs | 2,097,152 | 4.2 |
| `LargeBatch-Small` | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 533.84µs | 2,097,152 | 3.9 |
| `LargeBatch-Small` | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 707.36µs | 2,097,152 | 3.0 |
| `LargeBatch-Medium` | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 907.91µs | 67,108,864 | 73.9 |
| `LargeBatch-Medium` | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 898.93µs | 67,108,864 | 74.7 |
| `LargeBatch-Medium` | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 1.87ms | 67,108,864 | 35.8 |
| `LargeBatch-Medium` | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 5.17ms | 67,108,864 | 13.0 |
| `Batched-Large` | {16, 1536, 1920} | {16, 1920, 1024} | Float32 | 16 | 719.97ms | 96,636,764,160 | 134.2 |
| `Batched-Large` | {16, 1536, 1920} | {16, 1920, 1024} | Float64 | 16 | 742.60ms | 96,636,764,160 | 130.1 |
| `Batched-Large` | {16, 1536, 1920} | {16, 1920, 1024} | BFloat16 | 16 | 1.82s | 96,636,764,160 | 53.2 |
| `Batched-Large` | {16, 1536, 1920} | {16, 1920, 1024} | Float16 | 16 | 5.82s | 96,636,764,160 | 16.6 |
| `KA-Batch-16-#1` | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 320.64µs | 2,076,672 | 6.5 |
| `KA-Batch-16-#1` | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 309.92µs | 2,076,672 | 6.7 |
| `KA-Batch-16-#1` | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 371.07µs | 2,076,672 | 5.6 |
| `KA-Batch-16-#1` | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 569.04µs | 2,076,672 | 3.6 |
| `KA-Batch-16-#2` | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 306.84µs | 2,076,672 | 6.8 |
| `KA-Batch-16-#2` | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 350.17µs | 2,076,672 | 5.9 |
| `KA-Batch-16-#2` | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 372.44µs | 2,076,672 | 5.6 |
| `KA-Batch-16-#2` | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 538.75µs | 2,076,672 | 3.9 |
| `KA-Batch-16-#3` | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 4.75ms | 245,366,784 | 51.7 |
| `KA-Batch-16-#3` | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 4.80ms | 245,366,784 | 51.1 |
| `KA-Batch-16-#3` | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 9.07ms | 245,366,784 | 27.1 |
| `KA-Batch-16-#3` | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 23.98ms | 245,366,784 | 10.2 |
| `KA-Batch-16-#4` | {16, 13, 384} | {384, 1536} | Float32 | 1 | 3.92ms | 245,366,784 | 62.6 |
| `KA-Batch-16-#4` | {16, 13, 384} | {384, 1536} | Float64 | 1 | 4.08ms | 245,366,784 | 60.1 |
| `KA-Batch-16-#4` | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 7.41ms | 245,366,784 | 33.1 |
| `KA-Batch-16-#4` | {16, 13, 384} | {384, 1536} | Float16 | 1 | 19.59ms | 245,366,784 | 12.5 |
| `KA-Batch-16-#5` | {16, 13, 384} | {384, 384} | Float32 | 1 | 1.26ms | 61,341,696 | 48.5 |
| `KA-Batch-16-#5` | {16, 13, 384} | {384, 384} | Float64 | 1 | 1.33ms | 61,341,696 | 46.2 |
| `KA-Batch-16-#5` | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 2.38ms | 61,341,696 | 25.8 |
| `KA-Batch-16-#5` | {16, 13, 384} | {384, 384} | Float16 | 1 | 6.19ms | 61,341,696 | 9.9 |
| `adult-#1` | {128, 4} | {4, 1} | Float32 | 1 | 3.15µs | 1,024 | 0.3 |
| `adult-#1` | {128, 4} | {4, 1} | Float64 | 1 | 3.27µs | 1,024 | 0.3 |
| `adult-#1` | {128, 4} | {4, 1} | BFloat16 | 1 | 3.36µs | 1,024 | 0.3 |
| `adult-#1` | {128, 4} | {4, 1} | Float16 | 1 | 4.52µs | 1,024 | 0.2 |
| `adult-#2` | {128, 69} | {69, 4} | Float32 | 1 | 15.63µs | 70,656 | 4.5 |
| `adult-#2` | {128, 69} | {69, 4} | Float64 | 1 | 16.27µs | 70,656 | 4.3 |
| `adult-#2` | {128, 69} | {69, 4} | BFloat16 | 1 | 25.17µs | 70,656 | 2.8 |
| `adult-#2` | {128, 69} | {69, 4} | Float16 | 1 | 78.20µs | 70,656 | 0.9 |
| `adult-#3` | {25, 4} | {4, 1} | Float32 | 1 | 2.83µs | 200 | 0.1 |
| `adult-#3` | {25, 4} | {4, 1} | Float64 | 1 | 2.83µs | 200 | 0.1 |
| `adult-#3` | {25, 4} | {4, 1} | BFloat16 | 1 | 2.86µs | 200 | 0.1 |
| `adult-#3` | {25, 4} | {4, 1} | Float16 | 1 | 3.17µs | 200 | 0.1 |
| `adult-#4` | {25, 69} | {69, 4} | Float32 | 1 | 5.75µs | 13,800 | 2.4 |
| `adult-#4` | {25, 69} | {69, 4} | Float64 | 1 | 5.82µs | 13,800 | 2.4 |
| `adult-#4` | {25, 69} | {69, 4} | BFloat16 | 1 | 7.84µs | 13,800 | 1.8 |
| `adult-#4` | {25, 69} | {69, 4} | Float16 | 1 | 18.71µs | 13,800 | 0.7 |
| `adult-#5` | {49, 4} | {4, 1} | Float32 | 1 | 2.89µs | 392 | 0.1 |
| `adult-#5` | {49, 4} | {4, 1} | Float64 | 1 | 2.83µs | 392 | 0.1 |
| `adult-#5` | {49, 4} | {4, 1} | BFloat16 | 1 | 2.98µs | 392 | 0.1 |
| `adult-#5` | {49, 4} | {4, 1} | Float16 | 1 | 3.44µs | 392 | 0.1 |
| `adult-#6` | {49, 69} | {69, 4} | Float32 | 1 | 7.96µs | 27,048 | 3.4 |
| `adult-#6` | {49, 69} | {69, 4} | Float64 | 1 | 8.15µs | 27,048 | 3.3 |
| `adult-#6` | {49, 69} | {69, 4} | BFloat16 | 1 | 11.78µs | 27,048 | 2.3 |
| `adult-#6` | {49, 69} | {69, 4} | Float16 | 1 | 32.50µs | 27,048 | 0.8 |
| `adult-#6-Normalized` | {49, 69} | {4, 69} | Float32 | 1 | 8.47µs | 27,048 | 3.2 |
| `adult-#6-Normalized` | {49, 69} | {4, 69} | Float64 | 1 | 8.54µs | 27,048 | 3.2 |
| `adult-#6-Normalized` | {49, 69} | {4, 69} | BFloat16 | 1 | 14.47µs | 27,048 | 1.9 |
| `adult-#6-Normalized` | {49, 69} | {4, 69} | Float16 | 1 | 34.75µs | 27,048 | 0.8 |

With the experimental SIMD enabled for AVX-512 we get the following updates:

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `NoBatch-Medium` | {128, 128} | {128, 256} | Float32 | 1 | 9.07µs | 8,388,608 | 924.5 |
| `NoBatch-Large` | {1536, 1920} | {1920, 1024} | Float32 | 1 | 2.95ms | 6,039,797,760 | 2045.5 |
| `L-Unbalanced-Cross` | {4096, 32} | {32, 16} | Float32 | 1 | 11.31µs | 4,194,304 | 370.8 |
| `LargeBatch-Tiny` | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 806.62µs | 1,048,576 | 1.3 |
| `LargeBatch-Small` | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 171.54µs | 2,097,152 | 12.2 |
| `Batched-Large` | {16, 1536, 1920} | {16, 1920, 1024} | Float32 | 16 | 48.60ms | 96,636,764,160 | 1988.3 |
| `KA-Batch-16-#1` | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 113.87µs | 2,076,672 | 18.2 |
| `KA-Batch-16-#2` | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 138.35µs | 2,076,672 | 15.0 |

### Backend: `xla:cpu`/ CPU AMD 9950X3D / 2026-01-07 / PJRT Plugin v0.83.4 (see [pjrt-cpu-binaries](https://github.com/gomlx/pjrt-cpu-binaries/))

```bash
GOMLX_BACKEND=xla:cpu go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float32 | 1 | 5.22µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float64 | 1 | 4.65µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | BFloat16 | 1 | 5.08µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float16 | 1 | 4.56µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float32 | 1 | 4.99µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float64 | 1 | 4.24µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | BFloat16 | 1 | 4.46µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float16 | 1 | 4.47µs | 1,024 | 0.2 |
| NoBatch-Small | {16, 128} | {128, 32} | Float32 | 1 | 5.98µs | 131,072 | 21.9 |
| NoBatch-Small | {16, 128} | {128, 32} | Float64 | 1 | 9.78µs | 131,072 | 13.4 |
| NoBatch-Small | {16, 128} | {128, 32} | BFloat16 | 1 | 6.24µs | 131,072 | 21.0 |
| NoBatch-Small | {16, 128} | {128, 32} | Float16 | 1 | 6.60µs | 131,072 | 19.9 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float32 | 1 | 31.62µs | 8,388,608 | 265.3 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float64 | 1 | 69.00µs | 8,388,608 | 121.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | BFloat16 | 1 | 35.74µs | 8,388,608 | 234.7 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float16 | 1 | 34.86µs | 8,388,608 | 240.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float32 | 1 | 5.86µs | 65,536 | 11.2 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float64 | 1 | 6.25µs | 65,536 | 10.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | BFloat16 | 1 | 11.48µs | 65,536 | 5.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float16 | 1 | 13.00µs | 65,536 | 5.0 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float32 | 1 | 16.16µs | 4,194,304 | 259.5 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float64 | 1 | 78.40µs | 4,194,304 | 53.5 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | BFloat16 | 1 | 47.85µs | 4,194,304 | 87.7 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float16 | 1 | 41.12µs | 4,194,304 | 102.0 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 121.86µs | 1,048,576 | 8.6 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 67.46µs | 1,048,576 | 15.5 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 137.72µs | 1,048,576 | 7.6 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 139.25µs | 1,048,576 | 7.5 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 27.55µs | 2,097,152 | 76.1 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 124.81µs | 2,097,152 | 16.8 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 64.94µs | 2,097,152 | 32.3 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 62.58µs | 2,097,152 | 33.5 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 58.42µs | 67,108,864 | 1148.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 869.54µs | 67,108,864 | 77.2 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 143.19µs | 67,108,864 | 468.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 135.14µs | 67,108,864 | 496.6 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float32 | 1 | 1.74ms | 6,039,797,760 | 3478.8 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float64 | 1 | 17.01ms | 6,039,797,760 | 355.1 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 2.79ms | 6,039,797,760 | 2164.4 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float16 | 1 | 2.73ms | 6,039,797,760 | 2208.9 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 14.94µs | 2,076,672 | 139.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 122.06µs | 2,076,672 | 17.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 59.41µs | 2,076,672 | 35.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 50.21µs | 2,076,672 | 41.4 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 48.40µs | 2,076,672 | 42.9 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 121.16µs | 2,076,672 | 17.1 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 80.78µs | 2,076,672 | 25.7 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 82.16µs | 2,076,672 | 25.3 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 230.34µs | 245,366,784 | 1065.2 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 885.76µs | 245,366,784 | 277.0 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 376.54µs | 245,366,784 | 651.6 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 371.60µs | 245,366,784 | 660.3 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float32 | 1 | 146.28µs | 245,366,784 | 1677.3 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float64 | 1 | 871.00µs | 245,366,784 | 281.7 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 279.85µs | 245,366,784 | 876.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float16 | 1 | 276.67µs | 245,366,784 | 886.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float32 | 1 | 66.26µs | 61,341,696 | 925.7 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float64 | 1 | 284.29µs | 61,341,696 | 215.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 122.69µs | 61,341,696 | 500.0 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float16 | 1 | 115.85µs | 61,341,696 | 529.5 |
| adult-#1 | {128, 4} | {4, 1} | Float32 | 1 | 5.03µs | 1,024 | 0.2 |
| adult-#1 | {128, 4} | {4, 1} | Float64 | 1 | 4.09µs | 1,024 | 0.3 |
| adult-#1 | {128, 4} | {4, 1} | BFloat16 | 1 | 4.56µs | 1,024 | 0.2 |
| adult-#1 | {128, 4} | {4, 1} | Float16 | 1 | 4.40µs | 1,024 | 0.2 |
| adult-#2 | {128, 69} | {69, 4} | Float32 | 1 | 6.31µs | 70,656 | 11.2 |
| adult-#2 | {128, 69} | {69, 4} | Float64 | 1 | 8.46µs | 70,656 | 8.3 |
| adult-#2 | {128, 69} | {69, 4} | BFloat16 | 1 | 6.52µs | 70,656 | 10.8 |
| adult-#2 | {128, 69} | {69, 4} | Float16 | 1 | 6.78µs | 70,656 | 10.4 |
| adult-#3 | {25, 4} | {4, 1} | Float32 | 1 | 2.51µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float64 | 1 | 2.46µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | BFloat16 | 1 | 2.55µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float16 | 1 | 2.59µs | 200 | 0.1 |
| adult-#4 | {25, 69} | {69, 4} | Float32 | 1 | 5.88µs | 13,800 | 2.3 |
| adult-#4 | {25, 69} | {69, 4} | Float64 | 1 | 6.13µs | 13,800 | 2.2 |
| adult-#4 | {25, 69} | {69, 4} | BFloat16 | 1 | 6.28µs | 13,800 | 2.2 |
| adult-#4 | {25, 69} | {69, 4} | Float16 | 1 | 6.06µs | 13,800 | 2.3 |
| adult-#5 | {49, 4} | {4, 1} | Float32 | 1 | 2.55µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | Float64 | 1 | 2.50µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | BFloat16 | 1 | 2.58µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | Float16 | 1 | 2.57µs | 392 | 0.2 |
| adult-#6 | {49, 69} | {69, 4} | Float32 | 1 | 6.11µs | 27,048 | 4.4 |
| adult-#6 | {49, 69} | {69, 4} | Float64 | 1 | 6.26µs | 27,048 | 4.3 |
| adult-#6 | {49, 69} | {69, 4} | BFloat16 | 1 | 6.36µs | 27,048 | 4.3 |
| adult-#6 | {49, 69} | {69, 4} | Float16 | 1 | 6.43µs | 27,048 | 4.2 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float32 | 1 | 6.05µs | 27,048 | 4.5 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float64 | 1 | 6.25µs | 27,048 | 4.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | BFloat16 | 1 | 6.26µs | 27,048 | 4.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float16 | 1 | 6.34µs | 27,048 | 4.3 |

### Backend: `xla:cuda`/ GPU RTX 5090 / 2026-01-07 / PJRT Plugin v0.81 (Jax-build)

```bash
GOMLX_BACKEND=xla:cuda go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float32 | 1 | 16.54µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float64 | 1 | 19.12µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | BFloat16 | 1 | 16.36µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float16 | 1 | 16.75µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float32 | 1 | 25.42µs | 1,024 | 0.0 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float64 | 1 | 18.34µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | BFloat16 | 1 | 16.73µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float16 | 1 | 13.21µs | 1,024 | 0.1 |
| NoBatch-Small | {16, 128} | {128, 32} | Float32 | 1 | 15.14µs | 131,072 | 8.7 |
| NoBatch-Small | {16, 128} | {128, 32} | Float64 | 1 | 57.26µs | 131,072 | 2.3 |
| NoBatch-Small | {16, 128} | {128, 32} | BFloat16 | 1 | 20.31µs | 131,072 | 6.5 |
| NoBatch-Small | {16, 128} | {128, 32} | Float16 | 1 | 19.80µs | 131,072 | 6.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float32 | 1 | 31.13µs | 8,388,608 | 269.5 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float64 | 1 | 61.40µs | 8,388,608 | 136.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | BFloat16 | 1 | 25.45µs | 8,388,608 | 329.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float16 | 1 | 27.36µs | 8,388,608 | 306.6 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float32 | 1 | 26.19µs | 65,536 | 2.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float64 | 1 | 37.44µs | 65,536 | 1.8 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | BFloat16 | 1 | 18.96µs | 65,536 | 3.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float16 | 1 | 20.43µs | 65,536 | 3.2 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float32 | 1 | 27.46µs | 4,194,304 | 152.7 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float64 | 1 | 37.83µs | 4,194,304 | 110.9 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | BFloat16 | 1 | 35.60µs | 4,194,304 | 117.8 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float16 | 1 | 21.35µs | 4,194,304 | 196.4 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 14.58µs | 1,048,576 | 71.9 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 24.68µs | 1,048,576 | 42.5 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 13.91µs | 1,048,576 | 75.4 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 18.00µs | 1,048,576 | 58.3 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 17.52µs | 2,097,152 | 119.7 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 33.61µs | 2,097,152 | 62.4 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 17.62µs | 2,097,152 | 119.0 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 19.96µs | 2,097,152 | 105.0 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 30.76µs | 67,108,864 | 2181.9 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 88.47µs | 67,108,864 | 758.6 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 31.07µs | 67,108,864 | 2159.8 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 23.80µs | 67,108,864 | 2819.6 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float32 | 1 | 122.49µs | 6,039,797,760 | 49308.1 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float64 | 1 | 3.74ms | 6,039,797,760 | 1612.9 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 105.31µs | 6,039,797,760 | 57354.7 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float16 | 1 | 77.24µs | 6,039,797,760 | 78191.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 21.58µs | 2,076,672 | 96.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 39.08µs | 2,076,672 | 53.1 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 18.27µs | 2,076,672 | 113.7 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 16.83µs | 2,076,672 | 123.4 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 24.34µs | 2,076,672 | 85.3 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 42.36µs | 2,076,672 | 49.0 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 17.45µs | 2,076,672 | 119.0 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 16.61µs | 2,076,672 | 125.1 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 36.20µs | 245,366,784 | 6778.3 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 362.43µs | 245,366,784 | 677.0 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 35.80µs | 245,366,784 | 6854.2 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 35.61µs | 245,366,784 | 6890.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float32 | 1 | 36.45µs | 245,366,784 | 6731.2 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float64 | 1 | 200.16µs | 245,366,784 | 1225.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 27.12µs | 245,366,784 | 9047.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float16 | 1 | 161.30µs | 245,366,784 | 1521.2 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float32 | 1 | 26.79µs | 61,341,696 | 2289.6 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float64 | 1 | 115.20µs | 61,341,696 | 532.5 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 27.34µs | 61,341,696 | 2243.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float16 | 1 | 28.17µs | 61,341,696 | 2177.4 |
| adult-#1 | {128, 4} | {4, 1} | Float32 | 1 | 15.81µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | Float64 | 1 | 13.29µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | BFloat16 | 1 | 13.36µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | Float16 | 1 | 15.67µs | 1,024 | 0.1 |
| adult-#2 | {128, 69} | {69, 4} | Float32 | 1 | 30.56µs | 70,656 | 2.3 |
| adult-#2 | {128, 69} | {69, 4} | Float64 | 1 | 47.00µs | 70,656 | 1.5 |
| adult-#2 | {128, 69} | {69, 4} | BFloat16 | 1 | 23.42µs | 70,656 | 3.0 |
| adult-#2 | {128, 69} | {69, 4} | Float16 | 1 | 18.43µs | 70,656 | 3.8 |
| adult-#3 | {25, 4} | {4, 1} | Float32 | 1 | 14.25µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | Float64 | 1 | 15.60µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | BFloat16 | 1 | 13.00µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | Float16 | 1 | 13.15µs | 200 | 0.0 |
| adult-#4 | {25, 69} | {69, 4} | Float32 | 1 | 16.07µs | 13,800 | 0.9 |
| adult-#4 | {25, 69} | {69, 4} | Float64 | 1 | 46.55µs | 13,800 | 0.3 |
| adult-#4 | {25, 69} | {69, 4} | BFloat16 | 1 | 19.61µs | 13,800 | 0.7 |
| adult-#4 | {25, 69} | {69, 4} | Float16 | 1 | 18.47µs | 13,800 | 0.7 |
| adult-#5 | {49, 4} | {4, 1} | Float32 | 1 | 13.30µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | Float64 | 1 | 13.65µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | BFloat16 | 1 | 13.07µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | Float16 | 1 | 13.26µs | 392 | 0.0 |
| adult-#6 | {49, 69} | {69, 4} | Float32 | 1 | 16.80µs | 27,048 | 1.6 |
| adult-#6 | {49, 69} | {69, 4} | Float64 | 1 | 48.42µs | 27,048 | 0.6 |
| adult-#6 | {49, 69} | {69, 4} | BFloat16 | 1 | 20.76µs | 27,048 | 1.3 |
| adult-#6 | {49, 69} | {69, 4} | Float16 | 1 | 18.50µs | 27,048 | 1.5 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float32 | 1 | 15.60µs | 27,048 | 1.7 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float64 | 1 | 47.54µs | 27,048 | 0.6 |
| adult-#6-Normalized | {49, 69} | {4, 69} | BFloat16 | 1 | 20.91µs | 27,048 | 1.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float16 | 1 | 17.82µs | 27,048 | 1.5 |