# DotGeneral Performance

This document is generated by running the `TestDotGeneral_PerformanceTable` test. 
To run it, from the root of the repository, run (for the simplego backend):

```bash
GOMLX_BACKEND=go go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

## Results

### Backend: `go` / CPU AMD 9950X3D / 2026-01-07

```bash
GOMLX_BACKEND=go go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float32 | 1 | 3.06µs | 1,024 | 0.3 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float64 | 1 | 3.77µs | 1,024 | 0.3 |
| NoBatch-Tiny | {128, 4} | {4, 1} | BFloat16 | 1 | 4.00µs | 1,024 | 0.3 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float16 | 1 | 5.35µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float32 | 1 | 3.46µs | 1,024 | 0.3 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float64 | 1 | 3.42µs | 1,024 | 0.3 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | BFloat16 | 1 | 3.74µs | 1,024 | 0.3 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float16 | 1 | 5.19µs | 1,024 | 0.2 |
| NoBatch-Small | {16, 128} | {128, 32} | Float32 | 1 | 25.91µs | 131,072 | 5.1 |
| NoBatch-Small | {16, 128} | {128, 32} | Float64 | 1 | 39.39µs | 131,072 | 3.3 |
| NoBatch-Small | {16, 128} | {128, 32} | BFloat16 | 1 | 63.34µs | 131,072 | 2.1 |
| NoBatch-Small | {16, 128} | {128, 32} | Float16 | 1 | 139.83µs | 131,072 | 0.9 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float32 | 1 | 336.61µs | 8,388,608 | 24.9 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float64 | 1 | 355.06µs | 8,388,608 | 23.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | BFloat16 | 1 | 707.56µs | 8,388,608 | 11.9 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float16 | 1 | 1.50ms | 8,388,608 | 5.6 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float32 | 1 | 22.19µs | 65,536 | 3.0 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float64 | 1 | 91.12µs | 65,536 | 0.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | BFloat16 | 1 | 99.62µs | 65,536 | 0.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float16 | 1 | 137.64µs | 65,536 | 0.5 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float32 | 1 | 607.92µs | 4,194,304 | 6.9 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float64 | 1 | 624.17µs | 4,194,304 | 6.7 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | BFloat16 | 1 | 851.86µs | 4,194,304 | 4.9 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float16 | 1 | 1.37ms | 4,194,304 | 3.1 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 130.00µs | 1,048,576 | 8.1 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 133.18µs | 1,048,576 | 7.9 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 196.02µs | 1,048,576 | 5.3 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 376.73µs | 1,048,576 | 2.8 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 499.11µs | 2,097,152 | 4.2 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 548.44µs | 2,097,152 | 3.8 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 559.49µs | 2,097,152 | 3.7 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 710.30µs | 2,097,152 | 3.0 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 852.22µs | 67,108,864 | 78.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 883.23µs | 67,108,864 | 76.0 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 1.88ms | 67,108,864 | 35.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 4.87ms | 67,108,864 | 13.8 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float32 | 1 | 53.31ms | 6,039,797,760 | 113.3 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float64 | 1 | 59.34ms | 6,039,797,760 | 101.8 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 126.44ms | 6,039,797,760 | 47.8 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float16 | 1 | 357.90ms | 6,039,797,760 | 16.9 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 336.15µs | 2,076,672 | 6.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 370.46µs | 2,076,672 | 5.6 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 399.96µs | 2,076,672 | 5.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 591.42µs | 2,076,672 | 3.5 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 327.60µs | 2,076,672 | 6.3 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 363.15µs | 2,076,672 | 5.7 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 399.96µs | 2,076,672 | 5.2 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 555.53µs | 2,076,672 | 3.7 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 5.24ms | 245,366,784 | 46.8 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 5.50ms | 245,366,784 | 44.6 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 9.74ms | 245,366,784 | 25.2 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 22.89ms | 245,366,784 | 10.7 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float32 | 1 | 4.52ms | 245,366,784 | 54.3 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float64 | 1 | 4.74ms | 245,366,784 | 51.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 8.20ms | 245,366,784 | 29.9 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float16 | 1 | 19.01ms | 245,366,784 | 12.9 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float32 | 1 | 1.37ms | 61,341,696 | 44.6 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float64 | 1 | 1.44ms | 61,341,696 | 42.7 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 2.51ms | 61,341,696 | 24.4 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float16 | 1 | 5.88ms | 61,341,696 | 10.4 |
| adult-#1 | {128, 4} | {4, 1} | Float32 | 1 | 3.15µs | 1,024 | 0.3 |
| adult-#1 | {128, 4} | {4, 1} | Float64 | 1 | 3.80µs | 1,024 | 0.3 |
| adult-#1 | {128, 4} | {4, 1} | BFloat16 | 1 | 4.04µs | 1,024 | 0.3 |
| adult-#1 | {128, 4} | {4, 1} | Float16 | 1 | 5.41µs | 1,024 | 0.2 |
| adult-#2 | {128, 69} | {69, 4} | Float32 | 1 | 15.61µs | 70,656 | 4.5 |
| adult-#2 | {128, 69} | {69, 4} | Float64 | 1 | 17.85µs | 70,656 | 4.0 |
| adult-#2 | {128, 69} | {69, 4} | BFloat16 | 1 | 30.97µs | 70,656 | 2.3 |
| adult-#2 | {128, 69} | {69, 4} | Float16 | 1 | 73.80µs | 70,656 | 1.0 |
| adult-#3 | {25, 4} | {4, 1} | Float32 | 1 | 2.71µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float64 | 1 | 3.52µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | BFloat16 | 1 | 3.60µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float16 | 1 | 3.79µs | 200 | 0.1 |
| adult-#4 | {25, 69} | {69, 4} | Float32 | 1 | 5.41µs | 13,800 | 2.5 |
| adult-#4 | {25, 69} | {69, 4} | Float64 | 1 | 7.80µs | 13,800 | 1.8 |
| adult-#4 | {25, 69} | {69, 4} | BFloat16 | 1 | 10.83µs | 13,800 | 1.3 |
| adult-#4 | {25, 69} | {69, 4} | Float16 | 1 | 19.39µs | 13,800 | 0.7 |
| adult-#5 | {49, 4} | {4, 1} | Float32 | 1 | 2.79µs | 392 | 0.1 |
| adult-#5 | {49, 4} | {4, 1} | Float64 | 1 | 3.50µs | 392 | 0.1 |
| adult-#5 | {49, 4} | {4, 1} | BFloat16 | 1 | 3.67µs | 392 | 0.1 |
| adult-#5 | {49, 4} | {4, 1} | Float16 | 1 | 4.18µs | 392 | 0.1 |
| adult-#6 | {49, 69} | {69, 4} | Float32 | 1 | 7.77µs | 27,048 | 3.5 |
| adult-#6 | {49, 69} | {69, 4} | Float64 | 1 | 10.50µs | 27,048 | 2.6 |
| adult-#6 | {49, 69} | {69, 4} | BFloat16 | 1 | 15.54µs | 27,048 | 1.7 |
| adult-#6 | {49, 69} | {69, 4} | Float16 | 1 | 32.08µs | 27,048 | 0.8 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float32 | 1 | 8.10µs | 27,048 | 3.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float64 | 1 | 8.13µs | 27,048 | 3.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | BFloat16 | 1 | 13.98µs | 27,048 | 1.9 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float16 | 1 | 31.37µs | 27,048 | 0.9 |

### Backend: `xla:cpu`/ CPU AMD 9950X3D / 2026-01-07 / PJRT Plugin v0.83.4 (see [pjrt-cpu-binaries](https://github.com/gomlx/pjrt-cpu-binaries/))

```bash
GOMLX_BACKEND=xla:cpu go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float32 | 1 | 5.22µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float64 | 1 | 4.65µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | BFloat16 | 1 | 5.08µs | 1,024 | 0.2 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float16 | 1 | 4.56µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float32 | 1 | 4.99µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float64 | 1 | 4.24µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | BFloat16 | 1 | 4.46µs | 1,024 | 0.2 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float16 | 1 | 4.47µs | 1,024 | 0.2 |
| NoBatch-Small | {16, 128} | {128, 32} | Float32 | 1 | 5.98µs | 131,072 | 21.9 |
| NoBatch-Small | {16, 128} | {128, 32} | Float64 | 1 | 9.78µs | 131,072 | 13.4 |
| NoBatch-Small | {16, 128} | {128, 32} | BFloat16 | 1 | 6.24µs | 131,072 | 21.0 |
| NoBatch-Small | {16, 128} | {128, 32} | Float16 | 1 | 6.60µs | 131,072 | 19.9 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float32 | 1 | 31.62µs | 8,388,608 | 265.3 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float64 | 1 | 69.00µs | 8,388,608 | 121.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | BFloat16 | 1 | 35.74µs | 8,388,608 | 234.7 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float16 | 1 | 34.86µs | 8,388,608 | 240.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float32 | 1 | 5.86µs | 65,536 | 11.2 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float64 | 1 | 6.25µs | 65,536 | 10.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | BFloat16 | 1 | 11.48µs | 65,536 | 5.7 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float16 | 1 | 13.00µs | 65,536 | 5.0 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float32 | 1 | 16.16µs | 4,194,304 | 259.5 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float64 | 1 | 78.40µs | 4,194,304 | 53.5 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | BFloat16 | 1 | 47.85µs | 4,194,304 | 87.7 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float16 | 1 | 41.12µs | 4,194,304 | 102.0 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 121.86µs | 1,048,576 | 8.6 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 67.46µs | 1,048,576 | 15.5 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 137.72µs | 1,048,576 | 7.6 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 139.25µs | 1,048,576 | 7.5 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 27.55µs | 2,097,152 | 76.1 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 124.81µs | 2,097,152 | 16.8 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 64.94µs | 2,097,152 | 32.3 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 62.58µs | 2,097,152 | 33.5 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 58.42µs | 67,108,864 | 1148.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 869.54µs | 67,108,864 | 77.2 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 143.19µs | 67,108,864 | 468.7 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 135.14µs | 67,108,864 | 496.6 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float32 | 1 | 1.74ms | 6,039,797,760 | 3478.8 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float64 | 1 | 17.01ms | 6,039,797,760 | 355.1 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 2.79ms | 6,039,797,760 | 2164.4 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float16 | 1 | 2.73ms | 6,039,797,760 | 2208.9 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 14.94µs | 2,076,672 | 139.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 122.06µs | 2,076,672 | 17.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 59.41µs | 2,076,672 | 35.0 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 50.21µs | 2,076,672 | 41.4 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 48.40µs | 2,076,672 | 42.9 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 121.16µs | 2,076,672 | 17.1 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 80.78µs | 2,076,672 | 25.7 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 82.16µs | 2,076,672 | 25.3 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 230.34µs | 245,366,784 | 1065.2 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 885.76µs | 245,366,784 | 277.0 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 376.54µs | 245,366,784 | 651.6 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 371.60µs | 245,366,784 | 660.3 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float32 | 1 | 146.28µs | 245,366,784 | 1677.3 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float64 | 1 | 871.00µs | 245,366,784 | 281.7 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 279.85µs | 245,366,784 | 876.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float16 | 1 | 276.67µs | 245,366,784 | 886.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float32 | 1 | 66.26µs | 61,341,696 | 925.7 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float64 | 1 | 284.29µs | 61,341,696 | 215.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 122.69µs | 61,341,696 | 500.0 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float16 | 1 | 115.85µs | 61,341,696 | 529.5 |
| adult-#1 | {128, 4} | {4, 1} | Float32 | 1 | 5.03µs | 1,024 | 0.2 |
| adult-#1 | {128, 4} | {4, 1} | Float64 | 1 | 4.09µs | 1,024 | 0.3 |
| adult-#1 | {128, 4} | {4, 1} | BFloat16 | 1 | 4.56µs | 1,024 | 0.2 |
| adult-#1 | {128, 4} | {4, 1} | Float16 | 1 | 4.40µs | 1,024 | 0.2 |
| adult-#2 | {128, 69} | {69, 4} | Float32 | 1 | 6.31µs | 70,656 | 11.2 |
| adult-#2 | {128, 69} | {69, 4} | Float64 | 1 | 8.46µs | 70,656 | 8.3 |
| adult-#2 | {128, 69} | {69, 4} | BFloat16 | 1 | 6.52µs | 70,656 | 10.8 |
| adult-#2 | {128, 69} | {69, 4} | Float16 | 1 | 6.78µs | 70,656 | 10.4 |
| adult-#3 | {25, 4} | {4, 1} | Float32 | 1 | 2.51µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float64 | 1 | 2.46µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | BFloat16 | 1 | 2.55µs | 200 | 0.1 |
| adult-#3 | {25, 4} | {4, 1} | Float16 | 1 | 2.59µs | 200 | 0.1 |
| adult-#4 | {25, 69} | {69, 4} | Float32 | 1 | 5.88µs | 13,800 | 2.3 |
| adult-#4 | {25, 69} | {69, 4} | Float64 | 1 | 6.13µs | 13,800 | 2.2 |
| adult-#4 | {25, 69} | {69, 4} | BFloat16 | 1 | 6.28µs | 13,800 | 2.2 |
| adult-#4 | {25, 69} | {69, 4} | Float16 | 1 | 6.06µs | 13,800 | 2.3 |
| adult-#5 | {49, 4} | {4, 1} | Float32 | 1 | 2.55µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | Float64 | 1 | 2.50µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | BFloat16 | 1 | 2.58µs | 392 | 0.2 |
| adult-#5 | {49, 4} | {4, 1} | Float16 | 1 | 2.57µs | 392 | 0.2 |
| adult-#6 | {49, 69} | {69, 4} | Float32 | 1 | 6.11µs | 27,048 | 4.4 |
| adult-#6 | {49, 69} | {69, 4} | Float64 | 1 | 6.26µs | 27,048 | 4.3 |
| adult-#6 | {49, 69} | {69, 4} | BFloat16 | 1 | 6.36µs | 27,048 | 4.3 |
| adult-#6 | {49, 69} | {69, 4} | Float16 | 1 | 6.43µs | 27,048 | 4.2 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float32 | 1 | 6.05µs | 27,048 | 4.5 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float64 | 1 | 6.25µs | 27,048 | 4.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | BFloat16 | 1 | 6.26µs | 27,048 | 4.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float16 | 1 | 6.34µs | 27,048 | 4.3 |

### Backend: `xla:cuda`/ GPU RTX 5090 / 2026-01-07 / PJRT Plugin v0.81 (Jax-build)

```bash
GOMLX_BACKEND=xla:cuda go test -tags=perf ./backends/simplego/ \
    -test.run=TestDotGeneral_PerformanceTable -test.v -test.count=1 \
    -markdown
```

| Test Name | LHS Dims | RHS Dims | DType | BatchSize | Time/Run | Num Ops | GOps/Sec |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float32 | 1 | 16.54µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float64 | 1 | 19.12µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | BFloat16 | 1 | 16.36µs | 1,024 | 0.1 |
| NoBatch-Tiny | {128, 4} | {4, 1} | Float16 | 1 | 16.75µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float32 | 1 | 25.42µs | 1,024 | 0.0 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float64 | 1 | 18.34µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | BFloat16 | 1 | 16.73µs | 1,024 | 0.1 |
| NoBatch-Tiny-Normalized | {128, 4} | {1, 4} | Float16 | 1 | 13.21µs | 1,024 | 0.1 |
| NoBatch-Small | {16, 128} | {128, 32} | Float32 | 1 | 15.14µs | 131,072 | 8.7 |
| NoBatch-Small | {16, 128} | {128, 32} | Float64 | 1 | 57.26µs | 131,072 | 2.3 |
| NoBatch-Small | {16, 128} | {128, 32} | BFloat16 | 1 | 20.31µs | 131,072 | 6.5 |
| NoBatch-Small | {16, 128} | {128, 32} | Float16 | 1 | 19.80µs | 131,072 | 6.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float32 | 1 | 31.13µs | 8,388,608 | 269.5 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float64 | 1 | 61.40µs | 8,388,608 | 136.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | BFloat16 | 1 | 25.45µs | 8,388,608 | 329.6 |
| NoBatch-Medium | {128, 128} | {128, 256} | Float16 | 1 | 27.36µs | 8,388,608 | 306.6 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float32 | 1 | 26.19µs | 65,536 | 2.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float64 | 1 | 37.44µs | 65,536 | 1.8 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | BFloat16 | 1 | 18.96µs | 65,536 | 3.5 |
| NoBatch-NoLHSCross-LargeRHSCross-Matmul | {128} | {128, 256} | Float16 | 1 | 20.43µs | 65,536 | 3.2 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float32 | 1 | 27.46µs | 4,194,304 | 152.7 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float64 | 1 | 37.83µs | 4,194,304 | 110.9 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | BFloat16 | 1 | 35.60µs | 4,194,304 | 117.8 |
| NoBatch-LargeLHSCross-SmallRHSCross-Matmul | {4096, 32} | {32, 16} | Float16 | 1 | 21.35µs | 4,194,304 | 196.4 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float32 | 1024 | 14.58µs | 1,048,576 | 71.9 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float64 | 1024 | 24.68µs | 1,048,576 | 42.5 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | BFloat16 | 1024 | 13.91µs | 1,048,576 | 75.4 |
| LargeBatch-Tiny | {1024, 128, 4} | {1024, 4, 1} | Float16 | 1024 | 18.00µs | 1,048,576 | 58.3 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float32 | 256 | 17.52µs | 2,097,152 | 119.7 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float64 | 256 | 33.61µs | 2,097,152 | 62.4 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | BFloat16 | 256 | 17.62µs | 2,097,152 | 119.0 |
| LargeBatch-Small | {256, 8, 32} | {256, 32, 16} | Float16 | 256 | 19.96µs | 2,097,152 | 105.0 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float32 | 64 | 30.76µs | 67,108,864 | 2181.9 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float64 | 64 | 88.47µs | 67,108,864 | 758.6 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | BFloat16 | 64 | 31.07µs | 67,108,864 | 2159.8 |
| LargeBatch-Medium | {64, 64, 128} | {64, 64, 128} | Float16 | 64 | 23.80µs | 67,108,864 | 2819.6 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float32 | 1 | 122.49µs | 6,039,797,760 | 49308.1 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float64 | 1 | 3.74ms | 6,039,797,760 | 1612.9 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | BFloat16 | 1 | 105.31µs | 6,039,797,760 | 57354.7 |
| NoBatch-Large | {1536, 1920} | {1920, 1024} | Float16 | 1 | 77.24µs | 6,039,797,760 | 78191.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float32 | 192 | 21.58µs | 2,076,672 | 96.2 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float64 | 192 | 39.08µs | 2,076,672 | 53.1 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | BFloat16 | 192 | 18.27µs | 2,076,672 | 113.7 |
| KA-Batch-16-#1 | {16, 12, 13, 13} | {16, 12, 13, 32} | Float16 | 192 | 16.83µs | 2,076,672 | 123.4 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float32 | 192 | 24.34µs | 2,076,672 | 85.3 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float64 | 192 | 42.36µs | 2,076,672 | 49.0 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | BFloat16 | 192 | 17.45µs | 2,076,672 | 119.0 |
| KA-Batch-16-#2 | {16, 12, 13, 32} | {16, 12, 32, 13} | Float16 | 192 | 16.61µs | 2,076,672 | 125.1 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float32 | 1 | 36.20µs | 245,366,784 | 6778.3 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float64 | 1 | 362.43µs | 245,366,784 | 677.0 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | BFloat16 | 1 | 35.80µs | 245,366,784 | 6854.2 |
| KA-Batch-16-#3 | {16, 13, 1536} | {1536, 384} | Float16 | 1 | 35.61µs | 245,366,784 | 6890.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float32 | 1 | 36.45µs | 245,366,784 | 6731.2 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float64 | 1 | 200.16µs | 245,366,784 | 1225.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | BFloat16 | 1 | 27.12µs | 245,366,784 | 9047.8 |
| KA-Batch-16-#4 | {16, 13, 384} | {384, 1536} | Float16 | 1 | 161.30µs | 245,366,784 | 1521.2 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float32 | 1 | 26.79µs | 61,341,696 | 2289.6 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float64 | 1 | 115.20µs | 61,341,696 | 532.5 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | BFloat16 | 1 | 27.34µs | 61,341,696 | 2243.8 |
| KA-Batch-16-#5 | {16, 13, 384} | {384, 384} | Float16 | 1 | 28.17µs | 61,341,696 | 2177.4 |
| adult-#1 | {128, 4} | {4, 1} | Float32 | 1 | 15.81µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | Float64 | 1 | 13.29µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | BFloat16 | 1 | 13.36µs | 1,024 | 0.1 |
| adult-#1 | {128, 4} | {4, 1} | Float16 | 1 | 15.67µs | 1,024 | 0.1 |
| adult-#2 | {128, 69} | {69, 4} | Float32 | 1 | 30.56µs | 70,656 | 2.3 |
| adult-#2 | {128, 69} | {69, 4} | Float64 | 1 | 47.00µs | 70,656 | 1.5 |
| adult-#2 | {128, 69} | {69, 4} | BFloat16 | 1 | 23.42µs | 70,656 | 3.0 |
| adult-#2 | {128, 69} | {69, 4} | Float16 | 1 | 18.43µs | 70,656 | 3.8 |
| adult-#3 | {25, 4} | {4, 1} | Float32 | 1 | 14.25µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | Float64 | 1 | 15.60µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | BFloat16 | 1 | 13.00µs | 200 | 0.0 |
| adult-#3 | {25, 4} | {4, 1} | Float16 | 1 | 13.15µs | 200 | 0.0 |
| adult-#4 | {25, 69} | {69, 4} | Float32 | 1 | 16.07µs | 13,800 | 0.9 |
| adult-#4 | {25, 69} | {69, 4} | Float64 | 1 | 46.55µs | 13,800 | 0.3 |
| adult-#4 | {25, 69} | {69, 4} | BFloat16 | 1 | 19.61µs | 13,800 | 0.7 |
| adult-#4 | {25, 69} | {69, 4} | Float16 | 1 | 18.47µs | 13,800 | 0.7 |
| adult-#5 | {49, 4} | {4, 1} | Float32 | 1 | 13.30µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | Float64 | 1 | 13.65µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | BFloat16 | 1 | 13.07µs | 392 | 0.0 |
| adult-#5 | {49, 4} | {4, 1} | Float16 | 1 | 13.26µs | 392 | 0.0 |
| adult-#6 | {49, 69} | {69, 4} | Float32 | 1 | 16.80µs | 27,048 | 1.6 |
| adult-#6 | {49, 69} | {69, 4} | Float64 | 1 | 48.42µs | 27,048 | 0.6 |
| adult-#6 | {49, 69} | {69, 4} | BFloat16 | 1 | 20.76µs | 27,048 | 1.3 |
| adult-#6 | {49, 69} | {69, 4} | Float16 | 1 | 18.50µs | 27,048 | 1.5 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float32 | 1 | 15.60µs | 27,048 | 1.7 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float64 | 1 | 47.54µs | 27,048 | 0.6 |
| adult-#6-Normalized | {49, 69} | {4, 69} | BFloat16 | 1 | 20.91µs | 27,048 | 1.3 |
| adult-#6-Normalized | {49, 69} | {4, 69} | Float16 | 1 | 17.82µs | 27,048 | 1.5 |