// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build amd64 && goexperiment.simd

package packgemm

import (
	"simd/archsimd"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/gomlx/gomlx/internal/workerspool"
)

var GEMMSymmetric16RegistersFloat16 func(alpha hwy.Float16, beta hwy.Float16, lhsFlat []hwy.Float16, rhsFlat []hwy.Float16, batchSize int, lhsCrossSize int, rhsCrossSize int, contractingSize int, outputFlat []hwy.Float16, bufAllocFn BufAllocFn[hwy.Float16], bufReleaseFn BufReleaseFn, pool *workerspool.Pool) error
var GEMMSymmetric16RegistersBFloat16 func(alpha hwy.BFloat16, beta hwy.BFloat16, lhsFlat []hwy.BFloat16, rhsFlat []hwy.BFloat16, batchSize int, lhsCrossSize int, rhsCrossSize int, contractingSize int, outputFlat []hwy.BFloat16, bufAllocFn BufAllocFn[hwy.BFloat16], bufReleaseFn BufReleaseFn, pool *workerspool.Pool) error
var GEMMSymmetric16RegistersFloat32 func(alpha float32, beta float32, lhsFlat []float32, rhsFlat []float32, batchSize int, lhsCrossSize int, rhsCrossSize int, contractingSize int, outputFlat []float32, bufAllocFn BufAllocFn[float32], bufReleaseFn BufReleaseFn, pool *workerspool.Pool) error
var GEMMSymmetric16RegistersFloat64 func(alpha float64, beta float64, lhsFlat []float64, rhsFlat []float64, batchSize int, lhsCrossSize int, rhsCrossSize int, contractingSize int, outputFlat []float64, bufAllocFn BufAllocFn[float64], bufReleaseFn BufReleaseFn, pool *workerspool.Pool) error
var GEMMSymmetric16RegistersGemmChunkFloat16 func(alpha hwy.Float16, beta hwy.Float16, lhs []hwy.Float16, rhs []hwy.Float16, output []hwy.Float16, lhsCrossSize int, rhsCrossSize int, contractingSize int, params *CacheParams, lhsRowStart int, lhsRowEnd int, rhsColStart int, rhsColEnd int, packedLhs []hwy.Float16, packedRhs []hwy.Float16, packedOutput []hwy.Float16)
var GEMMSymmetric16RegistersGemmChunkBFloat16 func(alpha hwy.BFloat16, beta hwy.BFloat16, lhs []hwy.BFloat16, rhs []hwy.BFloat16, output []hwy.BFloat16, lhsCrossSize int, rhsCrossSize int, contractingSize int, params *CacheParams, lhsRowStart int, lhsRowEnd int, rhsColStart int, rhsColEnd int, packedLhs []hwy.BFloat16, packedRhs []hwy.BFloat16, packedOutput []hwy.BFloat16)
var GEMMSymmetric16RegistersGemmChunkFloat32 func(alpha float32, beta float32, lhs []float32, rhs []float32, output []float32, lhsCrossSize int, rhsCrossSize int, contractingSize int, params *CacheParams, lhsRowStart int, lhsRowEnd int, rhsColStart int, rhsColEnd int, packedLhs []float32, packedRhs []float32, packedOutput []float32)
var GEMMSymmetric16RegistersGemmChunkFloat64 func(alpha float64, beta float64, lhs []float64, rhs []float64, output []float64, lhsCrossSize int, rhsCrossSize int, contractingSize int, params *CacheParams, lhsRowStart int, lhsRowEnd int, rhsColStart int, rhsColEnd int, packedLhs []float64, packedRhs []float64, packedOutput []float64)
var GEMMSymmetric16RegistersPanelFloat16 func(activeContractingLen int, packedLHS []hwy.Float16, packedRHS []hwy.Float16, packedOutput []hwy.Float16, params *CacheParams, lhsActivePanelHeight int, rhsActivePanelWidth int)
var GEMMSymmetric16RegistersPanelBFloat16 func(activeContractingLen int, packedLHS []hwy.BFloat16, packedRHS []hwy.BFloat16, packedOutput []hwy.BFloat16, params *CacheParams, lhsActivePanelHeight int, rhsActivePanelWidth int)
var GEMMSymmetric16RegistersPanelFloat32 func(activeContractingLen int, packedLHS []float32, packedRHS []float32, packedOutput []float32, params *CacheParams, lhsActivePanelHeight int, rhsActivePanelWidth int)
var GEMMSymmetric16RegistersPanelFloat64 func(activeContractingLen int, packedLHS []float64, packedRHS []float64, packedOutput []float64, params *CacheParams, lhsActivePanelHeight int, rhsActivePanelWidth int)

// GEMMSymmetric16Registers is the generic API that dispatches to the appropriate SIMD implementation.
func GEMMSymmetric16Registers[T hwy.Floats](alpha T, beta T, lhsFlat []T, rhsFlat []T, batchSize int, lhsCrossSize int, rhsCrossSize int, contractingSize int, outputFlat []T, bufAllocFn BufAllocFn[T], bufReleaseFn BufReleaseFn, pool *workerspool.Pool) error {
	switch any(alpha).(type) {
	case hwy.Float16:
		return GEMMSymmetric16RegistersFloat16(any(alpha).(hwy.Float16), any(beta).(hwy.Float16), any(lhsFlat).([]hwy.Float16), any(rhsFlat).([]hwy.Float16), batchSize, lhsCrossSize, rhsCrossSize, contractingSize, any(outputFlat).([]hwy.Float16), any(bufAllocFn).(BufAllocFn[hwy.Float16]), bufReleaseFn, pool)
	case hwy.BFloat16:
		return GEMMSymmetric16RegistersBFloat16(any(alpha).(hwy.BFloat16), any(beta).(hwy.BFloat16), any(lhsFlat).([]hwy.BFloat16), any(rhsFlat).([]hwy.BFloat16), batchSize, lhsCrossSize, rhsCrossSize, contractingSize, any(outputFlat).([]hwy.BFloat16), any(bufAllocFn).(BufAllocFn[hwy.BFloat16]), bufReleaseFn, pool)
	case float32:
		return GEMMSymmetric16RegistersFloat32(any(alpha).(float32), any(beta).(float32), any(lhsFlat).([]float32), any(rhsFlat).([]float32), batchSize, lhsCrossSize, rhsCrossSize, contractingSize, any(outputFlat).([]float32), any(bufAllocFn).(BufAllocFn[float32]), bufReleaseFn, pool)
	case float64:
		return GEMMSymmetric16RegistersFloat64(any(alpha).(float64), any(beta).(float64), any(lhsFlat).([]float64), any(rhsFlat).([]float64), batchSize, lhsCrossSize, rhsCrossSize, contractingSize, any(outputFlat).([]float64), any(bufAllocFn).(BufAllocFn[float64]), bufReleaseFn, pool)
	}
	panic("unreachable")
}

// GEMMSymmetric16RegistersGemmChunk performs the 5-loop GotoBLAS algorithm on a slice of a single batch matrix.
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func GEMMSymmetric16RegistersGemmChunk[T hwy.Floats](alpha T, beta T, lhs []T, rhs []T, output []T, lhsCrossSize int, rhsCrossSize int, contractingSize int, params *CacheParams, lhsRowStart int, lhsRowEnd int, rhsColStart int, rhsColEnd int, packedLhs []T, packedRhs []T, packedOutput []T) {
	switch any(alpha).(type) {
	case hwy.Float16:
		GEMMSymmetric16RegistersGemmChunkFloat16(any(alpha).(hwy.Float16), any(beta).(hwy.Float16), any(lhs).([]hwy.Float16), any(rhs).([]hwy.Float16), any(output).([]hwy.Float16), lhsCrossSize, rhsCrossSize, contractingSize, params, lhsRowStart, lhsRowEnd, rhsColStart, rhsColEnd, any(packedLhs).([]hwy.Float16), any(packedRhs).([]hwy.Float16), any(packedOutput).([]hwy.Float16))
	case hwy.BFloat16:
		GEMMSymmetric16RegistersGemmChunkBFloat16(any(alpha).(hwy.BFloat16), any(beta).(hwy.BFloat16), any(lhs).([]hwy.BFloat16), any(rhs).([]hwy.BFloat16), any(output).([]hwy.BFloat16), lhsCrossSize, rhsCrossSize, contractingSize, params, lhsRowStart, lhsRowEnd, rhsColStart, rhsColEnd, any(packedLhs).([]hwy.BFloat16), any(packedRhs).([]hwy.BFloat16), any(packedOutput).([]hwy.BFloat16))
	case float32:
		GEMMSymmetric16RegistersGemmChunkFloat32(any(alpha).(float32), any(beta).(float32), any(lhs).([]float32), any(rhs).([]float32), any(output).([]float32), lhsCrossSize, rhsCrossSize, contractingSize, params, lhsRowStart, lhsRowEnd, rhsColStart, rhsColEnd, any(packedLhs).([]float32), any(packedRhs).([]float32), any(packedOutput).([]float32))
	case float64:
		GEMMSymmetric16RegistersGemmChunkFloat64(any(alpha).(float64), any(beta).(float64), any(lhs).([]float64), any(rhs).([]float64), any(output).([]float64), lhsCrossSize, rhsCrossSize, contractingSize, params, lhsRowStart, lhsRowEnd, rhsColStart, rhsColEnd, any(packedLhs).([]float64), any(packedRhs).([]float64), any(packedOutput).([]float64))
	}
}

// GEMMSymmetric16RegistersPanel computes a [lhsPanelHeight, rhsPanelWidth] block of the output matrix.
// It iterates over micro-kernels of size [params.LHSL1KernelRows, params.RHSL1KernelCols].
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func GEMMSymmetric16RegistersPanel[T hwy.Floats](activeContractingLen int, packedLHS []T, packedRHS []T, packedOutput []T, params *CacheParams, lhsActivePanelHeight int, rhsActivePanelWidth int) {
	switch any(packedLHS).(type) {
	case []hwy.Float16:
		GEMMSymmetric16RegistersPanelFloat16(activeContractingLen, any(packedLHS).([]hwy.Float16), any(packedRHS).([]hwy.Float16), any(packedOutput).([]hwy.Float16), params, lhsActivePanelHeight, rhsActivePanelWidth)
	case []hwy.BFloat16:
		GEMMSymmetric16RegistersPanelBFloat16(activeContractingLen, any(packedLHS).([]hwy.BFloat16), any(packedRHS).([]hwy.BFloat16), any(packedOutput).([]hwy.BFloat16), params, lhsActivePanelHeight, rhsActivePanelWidth)
	case []float32:
		GEMMSymmetric16RegistersPanelFloat32(activeContractingLen, any(packedLHS).([]float32), any(packedRHS).([]float32), any(packedOutput).([]float32), params, lhsActivePanelHeight, rhsActivePanelWidth)
	case []float64:
		GEMMSymmetric16RegistersPanelFloat64(activeContractingLen, any(packedLHS).([]float64), any(packedRHS).([]float64), any(packedOutput).([]float64), params, lhsActivePanelHeight, rhsActivePanelWidth)
	}
}

func init() {
	initGen_gemm16reg_dispatchAll()
}

func initGen_gemm16reg_dispatchAll() {
	if hwy.NoSimdEnv() {
		initGen_gemm16reg_dispatchFallback()
		return
	}
	if archsimd.X86.AVX512() {
		initGen_gemm16reg_dispatchAVX512()
		return
	}
	if archsimd.X86.AVX2() {
		initGen_gemm16reg_dispatchAVX2()
		return
	}
	initGen_gemm16reg_dispatchFallback()
}

func initGen_gemm16reg_dispatchAVX2() {
	GEMMSymmetric16RegistersFloat16 = BaseGEMMSymmetric16Registers_avx2_Float16
	GEMMSymmetric16RegistersBFloat16 = BaseGEMMSymmetric16Registers_avx2_BFloat16
	GEMMSymmetric16RegistersFloat32 = BaseGEMMSymmetric16Registers_avx2
	GEMMSymmetric16RegistersFloat64 = BaseGEMMSymmetric16Registers_avx2_Float64
	GEMMSymmetric16RegistersGemmChunkFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_avx2_Float16
	GEMMSymmetric16RegistersGemmChunkBFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_avx2_BFloat16
	GEMMSymmetric16RegistersGemmChunkFloat32 = BaseGEMMSymmetric16RegistersGemmChunk_avx2
	GEMMSymmetric16RegistersGemmChunkFloat64 = BaseGEMMSymmetric16RegistersGemmChunk_avx2_Float64
	GEMMSymmetric16RegistersPanelFloat16 = BaseGEMMSymmetric16RegistersPanel_avx2_Float16
	GEMMSymmetric16RegistersPanelBFloat16 = BaseGEMMSymmetric16RegistersPanel_avx2_BFloat16
	GEMMSymmetric16RegistersPanelFloat32 = BaseGEMMSymmetric16RegistersPanel_avx2
	GEMMSymmetric16RegistersPanelFloat64 = BaseGEMMSymmetric16RegistersPanel_avx2_Float64
}

func initGen_gemm16reg_dispatchAVX512() {
	GEMMSymmetric16RegistersFloat16 = BaseGEMMSymmetric16Registers_avx512_Float16
	GEMMSymmetric16RegistersBFloat16 = BaseGEMMSymmetric16Registers_avx512_BFloat16
	GEMMSymmetric16RegistersFloat32 = BaseGEMMSymmetric16Registers_avx512
	GEMMSymmetric16RegistersFloat64 = BaseGEMMSymmetric16Registers_avx512_Float64
	GEMMSymmetric16RegistersGemmChunkFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_avx512_Float16
	GEMMSymmetric16RegistersGemmChunkBFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_avx512_BFloat16
	GEMMSymmetric16RegistersGemmChunkFloat32 = BaseGEMMSymmetric16RegistersGemmChunk_avx512
	GEMMSymmetric16RegistersGemmChunkFloat64 = BaseGEMMSymmetric16RegistersGemmChunk_avx512_Float64
	GEMMSymmetric16RegistersPanelFloat16 = BaseGEMMSymmetric16RegistersPanel_avx512_Float16
	GEMMSymmetric16RegistersPanelBFloat16 = BaseGEMMSymmetric16RegistersPanel_avx512_BFloat16
	GEMMSymmetric16RegistersPanelFloat32 = BaseGEMMSymmetric16RegistersPanel_avx512
	GEMMSymmetric16RegistersPanelFloat64 = BaseGEMMSymmetric16RegistersPanel_avx512_Float64
}

func initGen_gemm16reg_dispatchFallback() {
	GEMMSymmetric16RegistersFloat16 = BaseGEMMSymmetric16Registers_fallback_Float16
	GEMMSymmetric16RegistersBFloat16 = BaseGEMMSymmetric16Registers_fallback_BFloat16
	GEMMSymmetric16RegistersFloat32 = BaseGEMMSymmetric16Registers_fallback
	GEMMSymmetric16RegistersFloat64 = BaseGEMMSymmetric16Registers_fallback_Float64
	GEMMSymmetric16RegistersGemmChunkFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_fallback_Float16
	GEMMSymmetric16RegistersGemmChunkBFloat16 = BaseGEMMSymmetric16RegistersGemmChunk_fallback_BFloat16
	GEMMSymmetric16RegistersGemmChunkFloat32 = BaseGEMMSymmetric16RegistersGemmChunk_fallback
	GEMMSymmetric16RegistersGemmChunkFloat64 = BaseGEMMSymmetric16RegistersGemmChunk_fallback_Float64
	GEMMSymmetric16RegistersPanelFloat16 = BaseGEMMSymmetric16RegistersPanel_fallback_Float16
	GEMMSymmetric16RegistersPanelBFloat16 = BaseGEMMSymmetric16RegistersPanel_fallback_BFloat16
	GEMMSymmetric16RegistersPanelFloat32 = BaseGEMMSymmetric16RegistersPanel_fallback
	GEMMSymmetric16RegistersPanelFloat64 = BaseGEMMSymmetric16RegistersPanel_fallback_Float64
}
