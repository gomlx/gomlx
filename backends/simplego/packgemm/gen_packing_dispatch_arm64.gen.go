// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build arm64

package packgemm

import (
	"github.com/ajroetker/go-highway/hwy"
)

var PackRHSFloat16 func(src []hwy.Float16, dst []hwy.Float16, srcRowStart int, srcColStart int, srcRowStride int, contractingRows int, numCols int, kernelCols int)
var PackRHSBFloat16 func(src []hwy.BFloat16, dst []hwy.BFloat16, srcRowStart int, srcColStart int, srcRowStride int, contractingRows int, numCols int, kernelCols int)
var PackRHSFloat32 func(src []float32, dst []float32, srcRowStart int, srcColStart int, srcRowStride int, contractingRows int, numCols int, kernelCols int)
var PackRHSFloat64 func(src []float64, dst []float64, srcRowStart int, srcColStart int, srcRowStride int, contractingRows int, numCols int, kernelCols int)
var ApplyPackedOutputFloat16 func(packedOutput []hwy.Float16, output []hwy.Float16, alpha hwy.Float16, beta hwy.Float16, packedOutputRowStride int, rowOffset int, colOffset int, outputRowStride int, height int, width int)
var ApplyPackedOutputBFloat16 func(packedOutput []hwy.BFloat16, output []hwy.BFloat16, alpha hwy.BFloat16, beta hwy.BFloat16, packedOutputRowStride int, rowOffset int, colOffset int, outputRowStride int, height int, width int)
var ApplyPackedOutputFloat32 func(packedOutput []float32, output []float32, alpha float32, beta float32, packedOutputRowStride int, rowOffset int, colOffset int, outputRowStride int, height int, width int)
var ApplyPackedOutputFloat64 func(packedOutput []float64, output []float64, alpha float64, beta float64, packedOutputRowStride int, rowOffset int, colOffset int, outputRowStride int, height int, width int)

// PackRHS packs a slice of size [contractingRows, numCols] block from RHS into
// the panel reshaped+transposed to [ceil(numCols/kernelCols), contractingRows, kernelCols],
// padding the cols of the last strip with zeros if necessary.
//
//   - src: [contractingSize, numCols]
//   - dst: a slice with enough size to hold the panel
//   - srcRowStart: start row in src
//   - srcColStart: start col in src
//   - srcRowStride: row-stride of src (number of columns per row in src)
//   - contractingRows: number of rows to be copied in the panel (must fit total panel allocated size)
//   - numCols: number of columns to be copied in the panel (excluding padding), will be padded to a kernelCols
//     multiple with zeros.
//   - kernelCols: number of columns in each "L1 kernel" (nr)
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func PackRHS[T hwy.Floats](src []T, dst []T, srcRowStart int, srcColStart int, srcRowStride int, contractingRows int, numCols int, kernelCols int) {
	switch any(src).(type) {
	case []hwy.Float16:
		PackRHSFloat16(any(src).([]hwy.Float16), any(dst).([]hwy.Float16), srcRowStart, srcColStart, srcRowStride, contractingRows, numCols, kernelCols)
	case []hwy.BFloat16:
		PackRHSBFloat16(any(src).([]hwy.BFloat16), any(dst).([]hwy.BFloat16), srcRowStart, srcColStart, srcRowStride, contractingRows, numCols, kernelCols)
	case []float32:
		PackRHSFloat32(any(src).([]float32), any(dst).([]float32), srcRowStart, srcColStart, srcRowStride, contractingRows, numCols, kernelCols)
	case []float64:
		PackRHSFloat64(any(src).([]float64), any(dst).([]float64), srcRowStart, srcColStart, srcRowStride, contractingRows, numCols, kernelCols)
	}
}

// ApplyPackedOutput apply a packageOutput "panel" back into the output matrix.
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func ApplyPackedOutput[T hwy.Floats](packedOutput []T, output []T, alpha T, beta T, packedOutputRowStride int, rowOffset int, colOffset int, outputRowStride int, height int, width int) {
	switch any(packedOutput).(type) {
	case []hwy.Float16:
		ApplyPackedOutputFloat16(any(packedOutput).([]hwy.Float16), any(output).([]hwy.Float16), any(alpha).(hwy.Float16), any(beta).(hwy.Float16), packedOutputRowStride, rowOffset, colOffset, outputRowStride, height, width)
	case []hwy.BFloat16:
		ApplyPackedOutputBFloat16(any(packedOutput).([]hwy.BFloat16), any(output).([]hwy.BFloat16), any(alpha).(hwy.BFloat16), any(beta).(hwy.BFloat16), packedOutputRowStride, rowOffset, colOffset, outputRowStride, height, width)
	case []float32:
		ApplyPackedOutputFloat32(any(packedOutput).([]float32), any(output).([]float32), any(alpha).(float32), any(beta).(float32), packedOutputRowStride, rowOffset, colOffset, outputRowStride, height, width)
	case []float64:
		ApplyPackedOutputFloat64(any(packedOutput).([]float64), any(output).([]float64), any(alpha).(float64), any(beta).(float64), packedOutputRowStride, rowOffset, colOffset, outputRowStride, height, width)
	}
}

func init() {
	if hwy.NoSimdEnv() {
		initGen_packing_dispatchFallback()
		return
	}
	initGen_packing_dispatchNEON()
	return
}

func initGen_packing_dispatchNEON() {
	PackRHSFloat16 = BasePackRHS_neon_Float16
	PackRHSBFloat16 = BasePackRHS_neon_BFloat16
	PackRHSFloat32 = BasePackRHS_neon
	PackRHSFloat64 = BasePackRHS_neon_Float64
	ApplyPackedOutputFloat16 = BaseApplyPackedOutput_neon_Float16
	ApplyPackedOutputBFloat16 = BaseApplyPackedOutput_neon_BFloat16
	ApplyPackedOutputFloat32 = BaseApplyPackedOutput_neon
	ApplyPackedOutputFloat64 = BaseApplyPackedOutput_neon_Float64
}

func initGen_packing_dispatchFallback() {
	PackRHSFloat16 = BasePackRHS_fallback_Float16
	PackRHSBFloat16 = BasePackRHS_fallback_BFloat16
	PackRHSFloat32 = BasePackRHS_fallback
	PackRHSFloat64 = BasePackRHS_fallback_Float64
	ApplyPackedOutputFloat16 = BaseApplyPackedOutput_fallback_Float16
	ApplyPackedOutputBFloat16 = BaseApplyPackedOutput_fallback_BFloat16
	ApplyPackedOutputFloat32 = BaseApplyPackedOutput_fallback
	ApplyPackedOutputFloat64 = BaseApplyPackedOutput_fallback_Float64
}
