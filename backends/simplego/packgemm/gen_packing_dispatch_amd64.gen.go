// Code generated by hwygen. DO NOT EDIT.
//go:build amd64 && goexperiment.simd

package packgemm

import (
	"os"

	"github.com/ajroetker/go-highway/hwy"
	"simd/archsimd"
)

var PackRHSFloat16 func(src []hwy.Float16, dst []hwy.Float16, srcRowStart int, srcColStart int, srcStrideCol int, contractingRows int, rhsCols int, RHSL1KernelCols int)
var PackRHSBFloat16 func(src []hwy.BFloat16, dst []hwy.BFloat16, srcRowStart int, srcColStart int, srcStrideCol int, contractingRows int, rhsCols int, RHSL1KernelCols int)
var PackRHSFloat32 func(src []float32, dst []float32, srcRowStart int, srcColStart int, srcStrideCol int, contractingRows int, rhsCols int, RHSL1KernelCols int)
var PackRHSFloat64 func(src []float64, dst []float64, srcRowStart int, srcColStart int, srcStrideCol int, contractingRows int, rhsCols int, RHSL1KernelCols int)

// PackRHS is the generic API that dispatches to the appropriate SIMD implementation.
func PackRHS[T hwy.Floats](src []T, dst []T, srcRowStart int, srcColStart int, srcStrideCol int, contractingRows int, rhsCols int, RHSL1KernelCols int) {
	switch any(src).(type) {
	case []hwy.Float16:
		PackRHSFloat16(any(src).([]hwy.Float16), any(dst).([]hwy.Float16), srcRowStart, srcColStart, srcStrideCol, contractingRows, rhsCols, RHSL1KernelCols)
	case []hwy.BFloat16:
		PackRHSBFloat16(any(src).([]hwy.BFloat16), any(dst).([]hwy.BFloat16), srcRowStart, srcColStart, srcStrideCol, contractingRows, rhsCols, RHSL1KernelCols)
	case []float32:
		PackRHSFloat32(any(src).([]float32), any(dst).([]float32), srcRowStart, srcColStart, srcStrideCol, contractingRows, rhsCols, RHSL1KernelCols)
	case []float64:
		PackRHSFloat64(any(src).([]float64), any(dst).([]float64), srcRowStart, srcColStart, srcStrideCol, contractingRows, rhsCols, RHSL1KernelCols)
	}
}

func init() {
	if os.Getenv("HWY_NO_SIMD") != "" {
		initGen_packing_dispatchFallback()
		return
	}
	if archsimd.X86.AVX512() {
		initGen_packing_dispatchAVX512()
		return
	}
	if archsimd.X86.AVX2() {
		initGen_packing_dispatchAVX2()
		return
	}
	initGen_packing_dispatchFallback()
}

func initGen_packing_dispatchAVX2() {
	PackRHSFloat16 = BasePackRHS_avx2_Float16
	PackRHSBFloat16 = BasePackRHS_avx2_BFloat16
	PackRHSFloat32 = BasePackRHS_avx2
	PackRHSFloat64 = BasePackRHS_avx2_Float64
}

func initGen_packing_dispatchAVX512() {
	PackRHSFloat16 = BasePackRHS_avx512_Float16
	PackRHSBFloat16 = BasePackRHS_avx512_BFloat16
	PackRHSFloat32 = BasePackRHS_avx512
	PackRHSFloat64 = BasePackRHS_avx512_Float64
}

func initGen_packing_dispatchFallback() {
	PackRHSFloat16 = BasePackRHS_fallback_Float16
	PackRHSBFloat16 = BasePackRHS_fallback_BFloat16
	PackRHSFloat32 = BasePackRHS_fallback
	PackRHSFloat64 = BasePackRHS_fallback_Float64
}
